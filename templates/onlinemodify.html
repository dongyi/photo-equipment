<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>编辑</title>
<script type="text/javascript" src="/static/js/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.jeditable.js"></script>
<script type="text/javascript" src="/static/js/jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.dataTables.min.js"></script>


<script type="text/javascript">
function getCookie(name) {
    var r = document.cookie.match("\\b" + name + "=([^;]*)\\b");
    return r ? r[1] : undefined;
}

$(document).ready(function() {
/* Init DataTables */
{% for sheet  in data.keys() %}
var oTable_{{sheet}} = $('#myTable_{{sheet}}').dataTable();

/* Apply the jEditable handlers to the table */
$('td', oTable_{{sheet}}.fnGetNodes()).editable( '/onlinemodify/{{category}}', {
    submit:'OK',
    indicator:'saving...',
    event:'click',
    cancel:'cancel',
    callback:function(sValue, y){
       oTable_{{sheet}}.fnUpdate( sValue, aPos[0], aPos[1] );
    },
    submitdata:function(){
        var res = {
        //_xsrf: getCookie("_xsrf"),
        category:"{{sheet}}",
        row: oTable_{{sheet}}.fnGetPosition( this )[0],
        column: oTable_{{sheet}}.fnGetPosition( this )[1]
       };
       res['_xsrf'] = getCookie("_xsrf");
       return res;
    },
} );

{% end %}
});

</script>
<link rel="stylesheet" type="text/css" href="/static/css/demo_table.css" />
<link rel="stylesheet" type="text/css" href="/static/css/demo_table_jui.css" />
<link rel="stylesheet" type="text/css" href="/static/css/demo_page.css" />
</head>

<body>

{% for sheet, content in data.items() %}
<h1>{{ category }}</h1>

<h2>sheet: {{ sheet }} </h2>
<table border="1" class="tablesorter" id="myTable_{{sheet}}">

<thead>
<tr>

{% for col in content[0] %}
  <th> {{ col }} </th>
{% end %}
</tr>
</thead>
<tbody>
{% for row in content[2:] %}
  <tr id="{{row[0]}}">
     {% for col in row %}
      <td> {{ col }} </td>
     {% end %}

  </tr>
{% end %}
</tbody>
</table>
{% end %}
<address>--------------</address>


<p><a href='/tools/{{category}}'>上传xls文件</a></p>

<p><a href='/onlinemodify/download?category={{category}}'> 下载文件 </a></p>

<p><a href='/onlinemodify/generate?category={{category}}'> 生成文件 </a></p>
{{ output }}


<hr>
<address></address>
<!-- hhmts start -->Last modified: Thu Jul 21 10:44:29 CST 2011 <!-- hhmts end -->
</body> </html>
